import { Meta, Canvas, Controls, Primary, ArgTypes } from '@storybook/blocks';
import { Do, Dont, Stack, CssVariables } from '@doc-components';
import css from '@digdir/designsystemet-css/input.css?inline';
import * as CheckboxStories from './Checkbox.stories';
import * as useCheckboxGroupStories from '../../../utilities/hooks/useCheckboxGroup/useCheckboxGroup.stories';

<Meta of={CheckboxStories} />

# Checkbox

Vi bruker `Checkbox` (avmerkingsboks) for å gi brukerne valg, der de kan velge ett eller flere alternativer. Brukerne kan både velge og oppheve valgene de gjør. Bruk [`Fieldset`](#fieldset) til å gruppere flere valg.

<Primary />
<Controls />

## Så använder du checkbox

```tsx
import { Checkbox } from '@digdir/designsystemet-react';

<Fieldset>
  <Fieldset.Legend>Skal du reise til noen av disse landene?</Fieldset.Legend>
  <Checkbox label='Kroatia' value='kroatia' />
  <Checkbox label='Slovakia' value='slovakia' />
  <Checkbox label='Hobsyssel' value='hobsyssel' />
  <Checkbox label='Jeg skal ikke til noen av disse landene' value='ingen' />
</Fieldset>;
```

## Exempel

<br />

### Endast ett val

Om användaren ska bekräfta något men inte välja något kan en `checkbox` stå ensam. Till exempel när användaren ska samtycka till villkor.

<Canvas of={CheckboxStories.OneOption} />

## `Fieldset` og `useCheckboxGroup`

Bruk `Fieldset` og `useCheckboxGroup` for gruppering av flere valg.

<Canvas of={CheckboxStories.Group} />

Til `useCheckboxGroup` kan du sende inn:

<ArgTypes of={useCheckboxGroupStories.UseCheckboxGroup} />

I respons får du objektet:

```ts
{
  getCheckboxProps: (value: string | { allowIndeterminate: true }) => CheckboxProps, // Returnerer props du kan spre på <Checkbox /> eller <input type="checkbox" />
  validationMessageProps: ValidationMessageProps, // Properties du kan valgfritt spre på ValidationMessage
  setValue: string[], // Funksjon for å sette checkbox gruppens verdi
  value: string[], // Nåværende verdi for checkbox gruppen
}
```

Eksempel på bruk:

```tsx
const { getCheckboxProps, validationMessageProps } = useCheckboxGroup({
  name: 'my-checkbox-group',
  value: [''],
  error: 'Du må velge et alternativ',
});

return (
  <Fieldset>
    <Fieldset.Legend>
      Skal du reise til noen av disse landene?
    </Fieldset.Legend>
    <Fieldset.Description>
      Velg alle landene du skal innom.
    </Fieldset.Description>
    <Checkbox label='Alle' {...getCheckboxProps({ allowIndeterminate: true })} />
    <Checkbox label='Kroatia' {...getCheckboxProps('kroatia')} />
    <Checkbox label='Slovakia' {...getCheckboxProps('slovakia')} />
    <Checkbox label='Hobsyssel' {...getCheckboxProps('hobsyssel')} />
    <ValidationMessage {...validationMessageProps} />
  </Fieldset>
);
```

### Obestämd

Använd `indeterminate` för att signalera att en eller flera kryssrutor är markerade i gruppen.

<Canvas of={CheckboxStories.InTable} />

#### Felmeddelande

Bruk `error` på `Fieldset` for å vise feilmelding.

Her må du bruke `Fieldset` for å gjøre innholdet tilgjengelig og aktivere riktig stil.

<Canvas of={CheckboxStories.WithError} />

#### Kontrollerad

Bruk `value` på `Checkbox` for å kontrollere verdiene selv.

<Canvas of={CheckboxStories.Controlled} />

#### Readonly

Fält med attributet `readonly` ingår i tabbsekvensen. Användarna kan kopiera innehållet men inte redigera det. Informationen följer med när formuläret skickas in.

`Readonly`-fält kan vara förvirrande för vissa användare. Alla förstår inte varför de inte kan ändra innehållet i fältet. Vi rekommenderar därför att undvika readonly så långt det går.

<Canvas of={CheckboxStories.ReadOnly} />

#### Disabled

Undvik inaktiverade tillstånd om du kan. De har låg färgkontrast som är problematisk för vissa användare. `Disabled` kan inte uppfylla kontrastkraven, vilket kan få användaren att tro att elementet är aktivt, försöka klicka på det och inte förstå varför det inte fungerar.

<Canvas of={CheckboxStories.Disabled} />

<br />

## Riktlinjer för checkbox

Om det finns fler än 7 svarsalternativ, använd istället [`Select`](/docs/komponenter-select--docs) eller [`Combobox`](/docs/komponenter-combobox--docs).

### Sortering

Alternativen ska som regel sorteras alfabetiskt. Om du väljer att presentera de mest relevanta alternativen först kan det bli svårt att hitta det önskade alternativet. Du riskerar också att påverka svaret, vilket inte är önskvärt.

### Placering

`Checkbox` ska som regel endast placeras vertikalt, med hänsyn till läsbarheten. Det är lättare för användarna att skanna listan när alternativen ligger under varandra. För användare som behöver zooma in på sidan för att se ordentligt är en horisontell lista extra svår.

<Stack
  direction='row'
  style={{
    justifyContent: 'unset',
    alignItems: 'unset',
  }}
>
  <Do
    description='Placera kryssrutorna vertikalt, så att listan blir lättare att läsa.'
    image='/img/component-guidelines/checkbox/CheckboxGroupV.png'
  />
  <Dont
    description='Undvik att placera kryssrutorna i flera kolumner.'
    image='/img/component-guidelines/checkbox/CheckboxGroupH.png'
  />
</Stack>

<br />

## Text i checkbox

I ett formulär formuleras ofta förklaringen som en fråga. Överväg om du behöver inkludera information om att användaren kan välja flera svarsalternativ.

Använd ett aktivt och positivt språk. Tänk på innehållet som en konversation. När `legend` är en mening kan du skriva den i du-form och svarsalternativen (`label`) i jag-form.

- `legend` och eventuell `description` placeras innan listan med svarsalternativ visas.
- `label` för varje ruta måste beskriva alternativet.
- `label` ska stå till höger om rutan. Om det behövs en extra beskrivning kan du lägga en `description` under `label`.
- `label` ska alltid ha versal första bokstav.

<img
  src='/img/component-guidelines/checkbox/checkbox-anatomy.png'
  alt='Illustrationen visar vad som är legend, description och label i en grupp med kryssrutor.'
/>

### Skapa logisk sammanhang mellan förklaringen och svarsalternativen

Användaren ska kunna läsa varje svarsalternativ som en logisk respons på förklaringen ovanför rutorna.

Exempel på korrekt logisk sammanhang:

<Canvas of={CheckboxStories.ContentEx1} />

### Ge svarsalternativen samma språkliga form

Det innebär att de kan ha antingen fullständiga meningar eller ett ord, men inte båda.

**Antingen:**

<Canvas of={CheckboxStories.ContentEx2} />

**Eller:**

<Canvas of={CheckboxStories.ContentEx3} />

<br />

## Tillgänglighet

Det ska vara möjligt att flytta fokus till `Checkbox` genom att trycka på `Tab` på tangentbordet. Det ska vara möjligt att markera och avmarkera genom att trycka på `Space`.

### Använd label

`Checkbox` ska alltid ha en `label`. Om du använder `label` från en annan plats, kom ihåg att använda `aria-label` eller `aria-labelledby` (Se koden nedan).

<Canvas of={CheckboxStories.AriaLabel} />

## CSS Variabler

<CssVariables css={css} />
